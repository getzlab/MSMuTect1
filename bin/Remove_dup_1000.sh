#Shell for removing duplicates
awk -v len=$2 '{split($1,a,"aaa");split(a[3],b,"_");if($4+a[2]+b[1]>len){print $3 a[2]"\t"$0}}' $1 | sort -u -k1,1 | awk '{$1="";print $0}' | awk '{split($1,a,"aaa");split(a[3],b,"_");split($3,c,":"); if( a[2]>10 && b[1] > 10 ){print $0};}' | awk '{split($1,a,"_"); print $3 "_"a[length(a)];}' | sort -n -k 1 | uniq --count |  awk '{split($2,a,"_"); print a[1]", "a[2]"_"$1; }' | awk -F '[,/]' 'r!=$1{if(p)print p; r=p=$1}{p=p","$NF}END{print p}' > $1_NoDup.hist

awk -v len=$2 '{split($1,a,"aaa");split(a[3],b,"_");if($4+a[2]+b[1]>len){print $3 a[2]"\t"$0}}' $1 | sort  -k1,1 | awk '{$1="";print $0}' | awk '{split($1,a,"aaa");split(a[3],b,"_");split($3,c,":"); if( a[2]>10 && b[1] > 10 ){print $0};}' | awk '{split($1,a,"_"); print $3 "_"a[length(a)];}' | sort -n -k 1 | uniq --count |  awk '{split($2,a,"_"); print a[1]", "a[2]"_"$1; }' | awk -F '[,/]' 'r!=$1{if(p)print p; r=p=$1}{p=p","$NF}END{print p}' > $1_Dup.hist

#awk '{split($1,a,"aaa");print $3 a[2]"\t"$0}' /xchip/cga/gdac-prod/cga/jobResults/MS_analysis_penta_hexa/GBM-TCGA-81-5911-Normal-SM-23IMU/4135180/AC_10.aln | sort -u -k1,1 | awk '{$1="";print $0}' | awk '{split($1,a,"aaa");split(a[5],b,"_");split($3,c,":"); if( a[4]>10 && b[1] > 10 ){print $0};}' | awk '{split($1,a,"_"); print $3 "_"a[length(a)];}' | sort -n -k 1 | uniq --count | awk '{split($2,a,"_"); print a[1]", "a[2]"_"$1; }' | awk -F '[,/]' 'r!=$1{if(p)print p; r=p=$1}{p=p","$NF}END{print p}' > /xchip/cga_home/maruvka/1000/NA20828_2/$2.NoDup.hist
#awk '{split($1,a,"aaa");print $3 a[2]"\t"$0}' /xchip/cga_home/maruvka/1000/NA20828_2/A_pure_10_50_fa.aln | sort -u -k1,2 | awk '{$1="";print $0}' | awk '{split($1,a,"aaa");split(a[5],b,"_");split($3,c,":"); if( a[4]>10 && b[1] > 10 ){print $0};}' | awk '{split($1,a,"_"); print $3 "_"a[length(a)];}' | sort -n -k 1 | uniq --count | awk '{split($2,a,"_"); print a[1]", "a[2]"_"$1; }' | awk -F '[,/]' 'r!=$1{if(p)print p; r=p=$1}{p=p","$NF}END{print p}' > /xchip/cga_home/maruvka/1000/NA20828_2/$2.NoDup.hist
#awk '{split($1,a,"aaa");print $3 a[2]"\t"$0}' /xchip/cga_home/maruvka/1000/NA20828_2/$2
